# Witkop et al. 2023 Manuscript Code

This repository houses code used to analyze and generate figures from scRNA-seq and ATAC-seq data presented in Witkop et al., 2023. 

### Analysis Scripts 

1. Scripts in the folders "ATAC_Scripts_FIGURES_TABLES_RECREATE" and "scRNA_seq_scripts_FIGURES_TABLES_RECREATE" should be referenced for directly making figures. Saved data objects referred to in each script are available for download via this [box folder](https://bri.box.com/s/v3sk3ptclfdnbdc3ebktwlcc3pvdcst5).
2. Scripts in the folders "ATAC_Scripts_for_reference" and "scRNAseq_Scripts_for_reference" should be used for referencing more complete code including additional analyses.


### FIGURE AND TABLE KEY
The code used to generate each figure or table is presented below for each part of every figure (A, B, C, D, E, F). Code sections are labelled within each script for the figure or table they support.

| FIGURE               | A                                            | B                                            | C                                            | D                                          | E                                          | F                                   |
|----------------------|----------------------------------------------|----------------------------------------------|----------------------------------------------|--------------------------------------------|--------------------------------------------|-------------------------------------|
| Figure 1             | Done in Inkscape                             | P452_3_T1DAL_Diffbind_Analysis_revised_FIGURES_TABLES_RECREATE.R     | P452_3_T1DAL_Diffbind_Analysis_revised_FIGURES_TABLES_RECREATE.R     | P452_3_T1DAL_Diffbind_Analysis_revised_FIGURES_TABLES_RECREATE.R   | NA                                         | NA                                  |
| Figure 2             | P452_3_T1DAL_Diffbind_Analysis_revised_FIGURES_TABLES_RECREATE.R     | P452_3_T1DAL_Diffbind_Analysis_revised_FIGURES_TABLES_RECREATE.R     | P452_3_T1DAL_Diffbind_Analysis_revised_FIGURES_TABLES_RECREATE.R     | NA                                         | NA                                         | NA                                  |
| Figure 3             | Done in Inkscape                             | P362_1_T1DAL_10X_Compiled_Analysis_revised_FIGURES_TABLES_RECREATE.R | P362_1_T1DAL_10X_Compiled_Analysis_revised_FIGURES_TABLES_RECREATE.R | P362_1_T1DAL_Tex_signature_UMAPs_revised_FIGURES_TABLES_RECREATE.R | NA                                         | NA                                  |
| Figure 4             | P362_1_T1DAL_DGEA_revised_FIGURES_TABLES_RECREATE.R                  | P452_3_HOMER_analysis_revised_FIGURES_TABLES_RECREATE.R              | P452_3_HOMER_analysis_revised_FIGURES_TABLES_RECREATE.R              | NA                                         | NA                                         | NA                                  |
| Figure 5             | P362_1_T1DAL_TCR_Analysis_revised_FIGURES_TABLES_RECREATE.R          | P362_1_T1DAL_TCR_Analysis_revised_FIGURES_TABLES_RECREATE.R          | P362_1_T1DAL_TCR_Analysis_revised_FIGURES_TABLES_RECREATE.R          | P362_1_T1DAL_TCR_Analysis_revised_FIGURES_TABLES_RECREATE.R        | P362_1_T1DAL_TCR_Analysis_revised_FIGURES_TABLES_RECREATE.R        | P362_1_T1DAL_TCR_Analysis_revised_FIGURES_TABLES_RECREATE.R |
| Figure 6             | P362_1_T1DAL_TCR_Analysis_revised_FIGURES_TABLES_RECREATE.R          | P362_1_T1DAL_TCR_Analysis_revised_FIGURES_TABLES_RECREATE.R          | Done in Inkscape                             | P362_1_T1DAL_TCR_Analysis_revised_FIGURES_TABLES_RECREATE.R        | NA                                         | NA                                  |

| SUPPLEMENTARY FIGUREs | A                                            | B                                            | C                                           | D                                          | E                                          | F  |
|----------------------|----------------------------------------------|----------------------------------------------|---------------------------------------------|--------------------------------------------|--------------------------------------------|----|
| Figure S1            | Done in flowjo and powerpoint                | NA                                           | NA                                          | NA                                         | NA                                         | NA |
| Figure S2            | P452_3_T1DAL_Diffbind_Analysis_revised_FIGURES_TABLES_RECREATE.R     | NA                                           | NA                                          | NA                                         | NA                                         | NA |
| Figure S3            | P452_3_T1DAL_Diffbind_Analysis_revised_FIGURES_TABLES_RECREATE.R     | NA                                           | NA                                          | NA                                         | NA                                         | NA |
| Figure S4            | Done in flowjo and powerpoint                | NA                                           | NA                                          | NA                                         | NA                                         | NA |
| Figure S5            | P362_1_T1DAL_DGEA_revised_FIGURES_TABLES_RECREATE.R                  | P362_1_T1DAL_DGEA_revised_FIGURES_TABLES_RECREATE.R                  | P362_1_T1DAL_Multimodal_reference_revised_FIGURES_TABLES_RECREATE.R | NA                                         | NA                                         | NA |
| Figure S6            | P362_1_T1DAL_pathology_association_revised_FIGURES_TABLES_RECREATE.R | P362_1_T1DAL_pathology_association_revised_FIGURES_TABLES_RECREATE.R | NA                                          | NA                                         | NA                                         | NA |
| Figure S7            | P362_1_T1DAL_Tex_signature_UMAPs_revised_FIGURES_TABLES_RECREATE.R   | P362_1_T1DAL_Tex_signature_UMAPs_revised_FIGURES_TABLES_RECREATE.R   | NA                                          | NA                                         | NA                                         | NA |
| Figure S8            | P362_1_T1DAL_DGEA_revised_FIGURES_TABLES_RECREATE.R                  | NA                                           | NA                                          | NA                                         | NA                                         | NA |
| Figure S9            | P362_1_T1DAL_DGEA_revised_FIGURES_TABLES_RECREATE.R                  | P362_1_T1DAL_DGEA_revised_FIGURES_TABLES_RECREATE.R                  | P362_1_T1DAL_DGEA_revised_FIGURES_TABLES_RECREATE.R                 | NA                                         | NA                                         | NA |
| Figure S10           | P362_1_T1DAL_TCR_Analysis_revised_FIGURES_TABLES_RECREATE.R          | P362_1_T1DAL_TCR_Analysis_revised_FIGURES_TABLES_RECREATE.R          | P362_1_T1DAL_TCR_Analysis_revised_FIGURES_TABLES_RECREATE.R         | NA                                         | NA                                         | NA |
| Figure S11           | P362_1_T1DAL_TCR_Analysis_revised_FIGURES_TABLES_RECREATE.R          | P362_1_T1DAL_TCR_Analysis_revised_FIGURES_TABLES_RECREATE.R          | NA                                          | NA                                         | NA                                         | NA |
| Figure S12           | P362_1_T1DAL_TCR_Analysis_revised_FIGURES_TABLES_RECREATE.R          | P362_1_T1DAL_TCR_Analysis_revised_FIGURES_TABLES_RECREATE.R          | NA                                          | NA                                         | NA                                         | NA |
| Figure S13           | P362_1_T1DAL_TCR_Analysis_revised_FIGURES_TABLES_RECREATE.R          | P362_1_T1DAL_TCR_Analysis_revised_FIGURES_TABLES_RECREATE.R          | NA                                          | NA                                         | NA                                         | NA |
| Figure S14           | P362_1_T1DAL_TCR_Analysis_revised_FIGURES_TABLES_RECREATE.R          | P362_1_T1DAL_TCR_Analysis_revised_FIGURES_TABLES_RECREATE.R          | P362_1_T1DAL_TCR_Analysis_revised_FIGURES_TABLES_RECREATE.R         | NA                                         | NA                                         | NA |
| Figure S15           | P362_1_T1DAL_10X_Compiled_Analysis_revised_FIGURES_TABLES_RECREATE.R | P362_1_T1DAL_10X_Compiled_Analysis_revised_FIGURES_TABLES_RECREATE.R | P362_1_T1DAL_Tex_signature_UMAPs_revised_FIGURES_TABLES_RECREATE.R  | P362_1_T1DAL_Tex_signature_UMAPs_revised_FIGURES_TABLES_RECREATE.R | NA                                         | NA |
| Figure S16           | P452_3_T1DAL_ATAC_seq_Comparison_revised_FIGURES_TABLES_RECREATE.R   | P452_3_T1DAL_ATAC_seq_Comparison_revised_FIGURES_TABLES_RECREATE.R   | P452_3_T1DAL_ATAC_seq_Comparison_revised_FIGURES_TABLES_RECREATE.R  | P452_3_T1DAL_ATAC_seq_Comparison_revised_FIGURES_TABLES_RECREATE.R | P452_3_T1DAL_ATAC_seq_Comparison_revised_FIGURES_TABLES_RECREATE.R | NA |

| TABLES   | A                                        | B                                        | C                                        | D                                        |   |   |
|----------|------------------------------------------|------------------------------------------|------------------------------------------|------------------------------------------|---|---|
| Table S1 | Compiled in word                         | NA                                       | NA                                       | NA                                       |   |   |
| Table S2 | P452_3_T1DAL_Diffbind_Analysis_revised_FIGURES_TABLES_RECREATE.R | P452_3_T1DAL_Diffbind_Analysis_revised_FIGURES_TABLES_RECREATE.R | P452_3_T1DAL_Diffbind_Analysis_revised_FIGURES_TABLES_RECREATE.R | P452_3_T1DAL_Diffbind_Analysis_revised_FIGURES_TABLES_RECREATE.R |   |   |
| Table S3 | P362_1_T1DAL_DGEA_revised_FIGURES_TABLES_RECREATE.R              | P362_1_T1DAL_DGEA_revised_FIGURES_TABLES_RECREATE.R              | P362_1_T1DAL_DGEA_revised_FIGURES_TABLES_RECREATE.R              | P362_1_T1DAL_DGEA_revised_FIGURES_TABLES_RECREATE.R              |   |   |
| Table S4 | P362_1_T1DAL_DGEA_revised_FIGURES_TABLES_RECREATE.R              | P362_1_T1DAL_DGEA_revised_FIGURES_TABLES_RECREATE.R              | NA                                       | NA                                       |   |   |
| Table S5 | P362_1_T1DAL_DGEA_revised_FIGURES_TABLES_RECREATE.R              | P362_1_T1DAL_DGEA_revised_FIGURES_TABLES_RECREATE.R              | NA                                       | NA                                       |   |   |
| Table S6 | P452_3_HOMER_analysis_revised_FIGURES_TABLES_RECREATE.R          | P452_3_HOMER_analysis_revised_FIGURES_TABLES_RECREATE.R          | P452_3_HOMER_analysis_revised_FIGURES_TABLES_RECREATE.R          | P452_3_HOMER_analysis_revised_FIGURES_TABLES_RECREATE.R          |   |   |
| Table S7 | P362_1_T1DAL_DGEA_revised_FIGURES_TABLES_RECREATE.R              | NA                                       | NA                                       | NA                                       |   |   |